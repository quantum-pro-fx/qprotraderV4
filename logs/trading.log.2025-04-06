2025-04-06 11:16:16,717 | INFO | TradingLogger initialized
2025-04-06 11:16:16,717 | ERROR | ERROR in system_run: [Errno 2] No such file or directory: 'models/agent.pkl'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._live_trading()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 68, in _live_trading
    self.agent = self._load_agent()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 115, in _load_agent
    with open(path, 'rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'models/agent.pkl'
2025-04-06 12:01:22,782 | INFO | TradingLogger initialized
2025-04-06 12:01:24,338 | INFO | METRIC training_start=1
2025-04-06 12:01:25,122 | ERROR | ERROR in system_run: index 0 is out of bounds for axis 0 with size 0
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0
2025-04-06 12:01:56,373 | INFO | TradingLogger initialized
2025-04-06 12:01:56,373 | INFO | SYSTEM EVENT: No agent loaded - attempting to load from disk
2025-04-06 12:01:56,374 | ERROR | ERROR in model_loading: No trained model at models/agent_latest.pkl
NoneType: None
2025-04-06 12:01:56,374 | INFO | SYSTEM EVENT: Starting training since no model exists
2025-04-06 12:01:57,558 | INFO | METRIC training_start=1
2025-04-06 12:01:58,232 | ERROR | ERROR in model_loading: index 0 is out of bounds for axis 0 with size 0
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 145, in _load_agent
    self._train()  # Automatically train if no model exists
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0
2025-04-06 12:01:58,246 | ERROR | ERROR in live_trading_startup: Failed to load agent. Please train first.
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 145, in _load_agent
    self._train()  # Automatically train if no model exists
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 73, in _live_trading
    self.agent = self._load_agent()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 155, in _load_agent
    raise RuntimeError("Failed to load agent. Please train first.") from e
RuntimeError: Failed to load agent. Please train first.
2025-04-06 12:01:58,246 | INFO | SYSTEM EVENT: Switching to training mode
2025-04-06 12:01:59,277 | INFO | METRIC training_start=1
2025-04-06 12:01:59,284 | ERROR | ERROR in system_run: index 0 is out of bounds for axis 0 with size 0
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 145, in _load_agent
    self._train()  # Automatically train if no model exists
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 73, in _live_trading
    self.agent = self._load_agent()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 155, in _load_agent
    raise RuntimeError("Failed to load agent. Please train first.") from e
RuntimeError: Failed to load agent. Please train first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0
2025-04-06 12:01:59,285 | ERROR | ERROR in system_run: index 0 is out of bounds for axis 0 with size 0
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 145, in _load_agent
    self._train()  # Automatically train if no model exists
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 73, in _live_trading
    self.agent = self._load_agent()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 155, in _load_agent
    raise RuntimeError("Failed to load agent. Please train first.") from e
RuntimeError: Failed to load agent. Please train first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 33, in run
    self._live_trading()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 103, in _live_trading
    self.run()  # Fall back to training
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0
2025-04-06 12:02:34,802 | INFO | TradingLogger initialized
2025-04-06 12:02:36,221 | INFO | METRIC training_start=1
2025-04-06 12:02:36,854 | ERROR | ERROR in system_run: index 0 is out of bounds for axis 0 with size 0
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 37, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 98, in _get_obs
    features = self.feature_engineer.transform(
IndexError: index 0 is out of bounds for axis 0 with size 0
2025-04-06 12:07:35,421 | INFO | TradingLogger initialized
2025-04-06 12:07:36,938 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 120, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 78, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 52, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 19, in __init__
    shape=(len(self.symbols), self._get_feature_dim())
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 92, in _get_feature_dim
    return len(self.feature_engineer.transform(dummy_df).columns)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 137, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:08:24,102 | INFO | TradingLogger initialized
2025-04-06 12:08:25,612 | ERROR | ERROR in system_run: Feature transformation failed: "['macd_line', 'macd_signal'] not in index"
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 127, in transform
    result[trend_features] = result[trend_features].ffill()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/frame.py", line 3899, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 6115, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 6179, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['macd_line', 'macd_signal'] not in index"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 19, in __init__
    shape=(len(self.symbols), self._get_feature_dim())
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 92, in _get_feature_dim
    return len(self.feature_engineer.transform(dummy_df).columns)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 137, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: "['macd_line', 'macd_signal'] not in index"
2025-04-06 12:08:59,485 | INFO | TradingLogger initialized
2025-04-06 12:09:01,061 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 122, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 80, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 54, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 19, in __init__
    shape=(len(self.symbols), self._get_feature_dim())
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 92, in _get_feature_dim
    return len(self.feature_engineer.transform(dummy_df).columns)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 139, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:11:04,186 | INFO | TradingLogger initialized
2025-04-06 12:11:05,718 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 123, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 81, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 54, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 19, in __init__
    shape=(len(self.symbols), self._get_feature_dim())
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 92, in _get_feature_dim
    return len(self.feature_engineer.transform(dummy_df).columns)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 140, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:34:06,959 | INFO | TradingLogger initialized
2025-04-06 12:34:08,222 | INFO | TradingLogger initialized
2025-04-06 12:34:08,246 | INFO | METRIC training_start=1
2025-04-06 12:34:08,941 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 123, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 81, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 54, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 39, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 130, in _get_obs
    features = self.feature_engineer.transform(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 140, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:34:56,707 | INFO | TradingLogger initialized
2025-04-06 12:34:58,242 | INFO | TradingLogger initialized
2025-04-06 12:34:58,257 | INFO | METRIC training_start=1
2025-04-06 12:34:58,776 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 120, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 78, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 52, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 39, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 130, in _get_obs
    features = self.feature_engineer.transform(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 137, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:36:51,740 | INFO | TradingLogger initialized
2025-04-06 12:36:52,934 | INFO | TradingLogger initialized
2025-04-06 12:36:52,944 | INFO | METRIC training_start=1
2025-04-06 12:36:53,462 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 122, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 80, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 54, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 39, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 130, in _get_obs
    features = self.feature_engineer.transform(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 139, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:39:12,129 | INFO | TradingLogger initialized
2025-04-06 12:39:12,890 | INFO | TradingLogger initialized
2025-04-06 12:39:12,903 | INFO | METRIC training_start=1
2025-04-06 12:39:13,429 | ERROR | ERROR in system_run: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 122, in transform
    result = self._calculate_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 80, in _calculate_features
    close_series, df = self._validate_input(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 54, in _validate_input
    raise ValueError(
ValueError: Insufficient data (1 rows). Minimum 50 required

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 51, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 77, in reset
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset(seed=self._seeds[env_idx], **maybe_options)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 39, in reset
    return self._get_obs(), {}  # (obs, info)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 130, in _get_obs
    features = self.feature_engineer.transform(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 139, in transform
    raise ValueError(f"Feature transformation failed: {str(e)}") from e
ValueError: Feature transformation failed: Insufficient data (1 rows). Minimum 50 required
2025-04-06 12:53:06,861 | INFO | TradingLogger initialized
2025-04-06 12:53:07,632 | INFO | TradingLogger initialized
2025-04-06 12:53:07,642 | INFO | METRIC training_start=1
2025-04-06 12:53:08,341 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,14) into shape (5,21)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 108, in _save_obs
    self.buf_obs[key][env_idx] = obs
ValueError: could not broadcast input array from shape (5,14) into shape (5,21)
2025-04-06 12:54:32,552 | INFO | TradingLogger initialized
2025-04-06 12:54:33,265 | INFO | TradingLogger initialized
2025-04-06 12:54:33,284 | INFO | METRIC training_start=1
2025-04-06 12:54:33,870 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,14) into shape (5,21)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 108, in _save_obs
    self.buf_obs[key][env_idx] = obs
ValueError: could not broadcast input array from shape (5,14) into shape (5,21)
2025-04-06 13:03:34,036 | INFO | TradingLogger initialized
2025-04-06 13:03:34,804 | INFO | TradingLogger initialized
2025-04-06 13:03:34,827 | INFO | METRIC training_start=1
2025-04-06 13:03:35,552 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,14) into shape (5,21)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 108, in _save_obs
    self.buf_obs[key][env_idx] = obs
ValueError: could not broadcast input array from shape (5,14) into shape (5,21)
2025-04-06 13:08:28,962 | INFO | TradingLogger initialized
2025-04-06 13:08:29,813 | INFO | TradingLogger initialized
2025-04-06 13:08:29,835 | INFO | METRIC training_start=1
2025-04-06 13:08:29,835 | ERROR | ERROR in system_run: 'MultiSymbolTradingEnv' object has no attribute 'num_envs'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 48, in _train
    model1 = PPOAgent(env)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/agents/ppo_agent.py", line 15, in __init__
    expected_shape = (env.num_envs, len(env.symbols), env.feature_dim)
AttributeError: 'MultiSymbolTradingEnv' object has no attribute 'num_envs'
2025-04-06 13:18:05,235 | INFO | TradingLogger initialized
2025-04-06 13:18:06,027 | INFO | TradingLogger initialized
2025-04-06 13:18:06,048 | INFO | METRIC training_start=1
2025-04-06 13:18:06,776 | ERROR | ERROR in system_run: Expected parameter logits (Tensor of shape (1, 3)) of distribution Categorical(logits: torch.Size([1, 3])) to satisfy the constraint IndependentConstraint(Real(), 1), but found invalid values:
tensor([[nan, nan, nan]])
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 277, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/policies.py", line 652, in forward
    distribution = self._get_action_dist_from_latent(latent_pi)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/policies.py", line 698, in _get_action_dist_from_latent
    return self.action_dist.proba_distribution(action_logits=mean_actions)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/distributions.py", line 342, in proba_distribution
    self.distribution = [Categorical(logits=split) for split in th.split(action_logits, list(self.action_dims), dim=1)]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/distributions.py", line 342, in <listcomp>
    self.distribution = [Categorical(logits=split) for split in th.split(action_logits, list(self.action_dims), dim=1)]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/distributions/categorical.py", line 72, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/distributions/distribution.py", line 71, in __init__
    raise ValueError(
ValueError: Expected parameter logits (Tensor of shape (1, 3)) of distribution Categorical(logits: torch.Size([1, 3])) to satisfy the constraint IndependentConstraint(Real(), 1), but found invalid values:
tensor([[nan, nan, nan]])
2025-04-06 13:32:08,865 | INFO | TradingLogger initialized
2025-04-06 13:32:10,035 | INFO | METRIC training_start=1
2025-04-06 17:09:53,625 | INFO | TradingLogger initialized
2025-04-06 17:09:54,583 | ERROR | ERROR in system_run: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 11, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 26, in _preprocess_data
    min_length = self.feature_engineer.min_data_points
AttributeError: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
2025-04-06 17:12:30,701 | INFO | TradingLogger initialized
2025-04-06 17:12:31,620 | ERROR | ERROR in system_run: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 11, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 26, in _preprocess_data
    min_length = self.feature_engineer.min_data_points
AttributeError: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
2025-04-06 17:13:28,145 | INFO | TradingLogger initialized
2025-04-06 17:13:29,008 | ERROR | ERROR in system_run: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 11, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 27, in _preprocess_data
    min_length = self.feature_engineer.min_data_points
AttributeError: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
2025-04-06 17:23:14,938 | INFO | TradingLogger initialized
2025-04-06 17:23:16,056 | ERROR | ERROR in system_run: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 11, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 27, in _preprocess_data
    min_length = self.feature_engineer.min_data_points
AttributeError: 'MultiSymbolTradingEnv' object has no attribute 'feature_engineer'
2025-04-06 17:26:20,698 | INFO | TradingLogger initialized
2025-04-06 17:26:21,638 | ERROR | ERROR in system_run: 'timestamp'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'timestamp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 12, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in _preprocess_data
    df = df.set_index(pd.to_datetime(df['timestamp']))
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'timestamp'
2025-04-06 17:37:55,446 | INFO | TradingLogger initialized
2025-04-06 17:37:56,399 | ERROR | ERROR in system_run: 'timestamp'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'timestamp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 13, in __init__
    self.symbol_data = self._preprocess_data(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in _preprocess_data
    df = df.set_index(pd.to_datetime(df['timestamp']))
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'timestamp'
2025-04-06 17:58:24,715 | INFO | TradingLogger initialized
2025-04-06 17:58:25,629 | INFO | TradingLogger initialized
2025-04-06 17:58:25,657 | ERROR | ERROR in system_run: name 'ee' is not defined
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 103, in transform
    df = self._calculate_ta_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 76, in _calculate_ta_features
    df['stoch_k'] = ta.stoch(high, low, close)['STOCHk_14_3_3']
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in __init__
    self.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 103, in reset
    return self._get_obs(), {}
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 206, in _get_obs
    features = self.feature_engineer.transform(window).iloc[-1].values
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 106, in transform
    raise ValueError(f"Feature engineering failed: {str(e)}") from ee
NameError: name 'ee' is not defined
2025-04-06 18:00:19,517 | INFO | TradingLogger initialized
2025-04-06 18:00:20,683 | INFO | TradingLogger initialized
2025-04-06 18:00:20,708 | ERROR | ERROR in system_run: Feature engineering failed: 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 103, in transform
    df = self._calculate_ta_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 76, in _calculate_ta_features
    df['stoch_k'] = ta.stoch(high, low, close)['STOCHk_14_3_3']
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in __init__
    self.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 103, in reset
    return self._get_obs(), {}
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 206, in _get_obs
    features = self.feature_engineer.transform(window).iloc[-1].values
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 106, in transform
    raise ValueError(f"Feature engineering failed: {str(e)}")
ValueError: Feature engineering failed: 'NoneType' object is not subscriptable
2025-04-06 19:46:23,517 | INFO | TradingLogger initialized
2025-04-06 19:46:24,469 | INFO | TradingLogger initialized
2025-04-06 19:46:24,492 | ERROR | ERROR in system_run: 'FeatureEngineer' object has no attribute 'feature_sets'
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 32, in __init__
    self.observation_space = self._init_observation_space()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 87, in _init_observation_space
    sample = self._get_sample_observation()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 194, in _get_sample_observation
    "market": np.zeros((len(self.symbols), len(self.feature_engineer.feature_sets['core']))),
AttributeError: 'FeatureEngineer' object has no attribute 'feature_sets'
2025-04-06 19:59:44,983 | INFO | TradingLogger initialized
2025-04-06 19:59:45,855 | INFO | TradingLogger initialized
2025-04-06 19:59:45,880 | ERROR | ERROR in system_run: Feature engineering failed: 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 105, in transform
    df = self._calculate_ta_features(df)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 78, in _calculate_ta_features
    df['stoch_k'] = ta.stoch(high, low, close)['STOCHk_14_3_3']
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in __init__
    self.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 103, in reset
    return self._get_obs(), {}
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 206, in _get_obs
    features = self.feature_engineer.transform(window).iloc[-1].values
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/data/processor.py", line 108, in transform
    raise ValueError(f"Feature engineering failed: {str(e)}")
ValueError: Feature engineering failed: 'NoneType' object is not subscriptable
2025-04-06 20:09:21,653 | INFO | TradingLogger initialized
2025-04-06 20:09:22,548 | INFO | TradingLogger initialized
2025-04-06 20:09:22,576 | ERROR | ERROR in system_run: single positional indexer is out-of-bounds
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 44, in _train
    env = MultiSymbolTradingEnv(symbol_data)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 35, in __init__
    self.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 103, in reset
    return self._get_obs(), {}
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/env/multi_symbol_env.py", line 206, in _get_obs
    features = self.feature_engineer.transform(window).iloc[-1].values
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexing.py", line 1153, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexing.py", line 1714, in _getitem_axis
    self._validate_integer(key, axis)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/pandas/core/indexing.py", line 1647, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2025-04-06 20:15:25,677 | INFO | TradingLogger initialized
2025-04-06 20:15:26,513 | INFO | TradingLogger initialized
2025-04-06 20:15:26,539 | INFO | METRIC training_start=1
2025-04-06 20:15:26,539 | ERROR | ERROR in system_run: The algorithm only supports (<class 'gymnasium.spaces.box.Box'>, <class 'gymnasium.spaces.discrete.Discrete'>, <class 'gymnasium.spaces.multi_discrete.MultiDiscrete'>, <class 'gymnasium.spaces.multi_binary.MultiBinary'>) as action spaces but Dict('AUD_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'EUR_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'GBP_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'USD_CAD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'USD_JPY': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32)) was provided
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 48, in _train
    model1 = PPOAgent(env)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/agents/ppo_agent.py", line 40, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 109, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 85, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 180, in __init__
    assert isinstance(self.action_space, supported_action_spaces), (
AssertionError: The algorithm only supports (<class 'gymnasium.spaces.box.Box'>, <class 'gymnasium.spaces.discrete.Discrete'>, <class 'gymnasium.spaces.multi_discrete.MultiDiscrete'>, <class 'gymnasium.spaces.multi_binary.MultiBinary'>) as action spaces but Dict('AUD_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'EUR_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'GBP_USD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'USD_CAD': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32), 'USD_JPY': Box([-1.  0.  0.], [1.   0.05 0.05], (3,), float32)) was provided
2025-04-06 20:47:25,161 | INFO | TradingLogger initialized
2025-04-06 20:47:26,078 | INFO | TradingLogger initialized
2025-04-06 20:47:26,115 | INFO | METRIC training_start=1
2025-04-06 20:47:26,115 | ERROR | ERROR in system_run: You must use `MultiInputPolicy` when working with dict observation space, not MlpPolicy
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 48, in _train
    model1 = PPOAgent(env)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/agents/ppo_agent.py", line 40, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 109, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 85, in __init__
    super().__init__(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 192, in __init__
    raise ValueError(f"You must use `MultiInputPolicy` when working with dict observation space, not {policy}")
ValueError: You must use `MultiInputPolicy` when working with dict observation space, not MlpPolicy
2025-04-06 20:52:38,091 | INFO | TradingLogger initialized
2025-04-06 20:52:38,969 | INFO | TradingLogger initialized
2025-04-06 20:52:39,009 | INFO | METRIC training_start=1
2025-04-06 20:52:39,703 | ERROR | ERROR in system_run: Expected parameter loc (Tensor of shape (1, 15)) of distribution Normal(loc: torch.Size([1, 15]), scale: torch.Size([1, 15])) to satisfy the constraint Real(), but found invalid values:
tensor([[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]])
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 277, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/policies.py", line 652, in forward
    distribution = self._get_action_dist_from_latent(latent_pi)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/policies.py", line 692, in _get_action_dist_from_latent
    return self.action_dist.proba_distribution(mean_actions, self.log_std)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/distributions.py", line 164, in proba_distribution
    self.distribution = Normal(mean_actions, action_std)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/distributions/normal.py", line 59, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/torch/distributions/distribution.py", line 71, in __init__
    raise ValueError(
ValueError: Expected parameter loc (Tensor of shape (1, 15)) of distribution Normal(loc: torch.Size([1, 15]), scale: torch.Size([1, 15])) to satisfy the constraint Real(), but found invalid values:
tensor([[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]])
2025-04-06 20:56:26,188 | INFO | TradingLogger initialized
2025-04-06 20:56:27,025 | INFO | TradingLogger initialized
2025-04-06 20:56:27,065 | INFO | METRIC training_start=1
2025-04-06 20:56:27,745 | ERROR | ERROR in system_run: found nan in observations.market.
Originated from the environment observation (at reset)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 31, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 49, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_check_nan.py", line 47, in reset
    self._check_val(event="reset", observations=observations)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_check_nan.py", line 106, in _check_val
    raise ValueError(msg)
ValueError: found nan in observations.market.
Originated from the environment observation (at reset)
2025-04-06 22:11:35,604 | INFO | TradingLogger initialized
2025-04-06 22:11:36,788 | INFO | METRIC training_start=1
2025-04-06 22:11:36,788 | ERROR | ERROR in system_run: The environment is of type <class 'stable_baselines3.common.vec_env.vec_check_nan.VecCheckNan'>, not a Gymnasium environment. In this case, we expect OpenAI Gym to be installed and the environment to be an OpenAI Gym environment.
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 33, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 55, in _train
    model1 = InstitutionalPPO(env)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/agents/ppo_agent.py", line 49, in __init__
    env = DummyVecEnv([lambda: env])
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 30, in __init__
    self.envs = [_patch_env(fn()) for fn in env_fns]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 30, in <listcomp>
    self.envs = [_patch_env(fn()) for fn in env_fns]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/patch_gym.py", line 33, in _patch_env
    raise ValueError(
ValueError: The environment is of type <class 'stable_baselines3.common.vec_env.vec_check_nan.VecCheckNan'>, not a Gymnasium environment. In this case, we expect OpenAI Gym to be installed and the environment to be an OpenAI Gym environment.
2025-04-06 22:39:32,620 | INFO | TradingLogger initialized
2025-04-06 22:39:33,462 | INFO | METRIC training_start=1
2025-04-06 22:45:30,866 | INFO | TradingLogger initialized
2025-04-06 22:45:31,730 | INFO | METRIC training_start=1
2025-04-06 22:50:50,999 | INFO | TradingLogger initialized
2025-04-06 22:50:52,750 | INFO | METRIC training_start=1
2025-04-06 22:52:25,365 | INFO | TradingLogger initialized
2025-04-06 22:52:27,451 | INFO | METRIC training_start=1
2025-04-06 22:53:16,616 | INFO | TradingLogger initialized
2025-04-06 22:53:18,410 | INFO | METRIC training_start=1
2025-04-06 22:54:15,354 | INFO | TradingLogger initialized
2025-04-06 22:54:16,590 | INFO | METRIC training_start=1
2025-04-06 22:54:58,170 | INFO | TradingLogger initialized
2025-04-06 22:54:59,986 | INFO | METRIC training_start=1
2025-04-06 22:55:53,946 | INFO | TradingLogger initialized
2025-04-06 22:55:55,473 | INFO | METRIC training_start=1
2025-04-06 22:56:29,800 | INFO | TradingLogger initialized
2025-04-06 22:56:31,053 | INFO | METRIC training_start=1
2025-04-06 22:58:11,929 | INFO | TradingLogger initialized
2025-04-06 22:58:13,618 | INFO | METRIC training_start=1
2025-04-06 22:58:53,469 | INFO | TradingLogger initialized
2025-04-06 22:58:54,601 | INFO | METRIC training_start=1
2025-04-06 22:59:33,950 | INFO | TradingLogger initialized
2025-04-06 22:59:35,800 | INFO | METRIC training_start=1
2025-04-06 22:59:48,168 | INFO | TradingLogger initialized
2025-04-06 22:59:49,715 | INFO | METRIC training_start=1
2025-04-06 23:01:47,741 | INFO | TradingLogger initialized
2025-04-06 23:01:49,131 | INFO | METRIC training_start=1
2025-04-06 23:01:49,838 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,7) into shape (5,3)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 33, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 56, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_check_nan.py", line 46, in reset
    observations = self.venv.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 110, in _save_obs
    self.buf_obs[key][env_idx] = obs[key]  # type: ignore[call-overload]
ValueError: could not broadcast input array from shape (5,7) into shape (5,3)
2025-04-06 23:09:08,431 | INFO | TradingLogger initialized
2025-04-06 23:09:10,055 | INFO | METRIC training_start=1
2025-04-06 23:13:21,678 | INFO | TradingLogger initialized
2025-04-06 23:13:23,231 | INFO | METRIC training_start=1
2025-04-06 23:14:24,226 | INFO | TradingLogger initialized
2025-04-06 23:14:25,729 | INFO | METRIC training_start=1
2025-04-06 23:14:42,396 | INFO | TradingLogger initialized
2025-04-06 23:14:43,606 | INFO | METRIC training_start=1
2025-04-06 23:15:08,761 | INFO | TradingLogger initialized
2025-04-06 23:15:10,220 | INFO | METRIC training_start=1
2025-04-06 23:15:11,034 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,22) into shape (5,3)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 33, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 56, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_check_nan.py", line 46, in reset
    observations = self.venv.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 110, in _save_obs
    self.buf_obs[key][env_idx] = obs[key]  # type: ignore[call-overload]
ValueError: could not broadcast input array from shape (5,22) into shape (5,3)
2025-04-06 23:26:23,262 | INFO | TradingLogger initialized
2025-04-06 23:26:24,966 | INFO | METRIC training_start=1
2025-04-06 23:32:56,662 | INFO | TradingLogger initialized
2025-04-06 23:32:58,390 | INFO | METRIC training_start=1
2025-04-06 23:32:59,043 | ERROR | ERROR in system_run: could not broadcast input array from shape (5,35) into shape (5,3)
Traceback (most recent call last):
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 33, in run
    self._train()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/core/system.py", line 56, in _train
    model1.learn(total_timesteps=100000)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 264, in learn
    total_timesteps, callback = self._setup_learn(
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/base_class.py", line 423, in _setup_learn
    self._last_obs = self.env.reset()  # type: ignore[assignment]
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_check_nan.py", line 46, in reset
    observations = self.venv.reset()
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 78, in reset
    self._save_obs(env_idx, obs)
  File "/Users/benjaminigbokwe/projects/qprotraderV4/myenv/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 110, in _save_obs
    self.buf_obs[key][env_idx] = obs[key]  # type: ignore[call-overload]
ValueError: could not broadcast input array from shape (5,35) into shape (5,3)
